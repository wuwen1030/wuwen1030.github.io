<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Ben's Homepage">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Ben's Homepage">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ben's Homepage">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Ben's Homepage </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Ben's Homepage</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">君子善假于物</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/05/20/2015-05-20-at-ibdesignable-suo-jian-ji-suo-de-de-custom-view/" itemprop="url">
                  @IBDesignable-所见即所得的Custom View
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-05-20T15:02:52+08:00" content="2015-05-20">
              2015-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS开发/" itemprop="url" rel="index">
                    <span itemprop="name">iOS开发</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>iOS8发布后，XCode对自定义控件支持有所加强，之前在途牛旅游客户端开发了一个通用的控件<code>TNStepper</code>，这篇文章主要通过升级<code>TNStepper</code>来简单介绍这项新技术<strong><code>@IBDesignable``@IBInspectable</code></strong>。</p>
<p><img src="http://i1.tietuku.com/d1705b698382ded0.png" alt="image1"></p>
<p>###问题<br>在iOS的开发中，对于一些具备独立功能的可复用的控件我们往往会把它做成一个自定的控件（<code>custom view</code>）。使用控件时，我们调用<code>initWithFrame:</code>方法创建控件，对于<code>storyboard/xib</code>，我们通过在<code>storyboard/xib</code>拖拽一个<code>UIView</code>控件（要求自定义控件实现<code>initWithCoder:</code>方法），并将其<code>Class</code>指定为<code>MyCustomView</code>。我们看到的一个空白的<code>view</code>，并不是我们设计好的<code>custom view</code>，根本没有发挥<code>storyboard/xib</code>所见即所得优势，也没法动态去看到<code>custom view</code>属性调整后的效果。</p>
<p>###@IBDesignable实时渲染<br>本文使用<code>Swift</code>编写了<code>TNStepper</code>的升级版<a href="https://github.com/wuwen1030/VisualStepper" target="_blank" rel="external">VisualStepper</a>，通过该控件来简单介绍这项新技术，读者可先行下载代码。工程目录如下，<code>XTStepper</code>为我们的自定义View。</p>
<p><img src="http://i1.tietuku.com/b82b3f0936815e7c.jpg" alt="image2"></p>
<p>首先简单介绍一下<code>XTStepper</code>的代码，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">override init(frame: CGRect) &#123;</span><br><span class="line">    super.init(frame: frame)</span><br><span class="line">    xibSetup()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">required init(coder aDecoder: NSCoder) &#123;</span><br><span class="line">    super.init(coder: aDecoder)</span><br><span class="line">    xibSetup()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func xibSetup() &#123;</span><br><span class="line">    view = loadViewFromNib()</span><br><span class="line">    // Add constraint here</span><br><span class="line">    ...</span><br><span class="line">    self.updateApperance()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func loadViewFromNib() -&gt; UIView &#123;</span><br><span class="line">    let bundle = NSBundle(forClass: self.dynamicType)</span><br><span class="line">    let nib = UINib(nibName: &quot;XTStepper&quot;, bundle: bundle)</span><br><span class="line">    let view = nib.instantiateWithOwner(self, options: nil)[0] as! UIView</span><br><span class="line">    return view</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>作为一个重度的<code>storyboard/xib</code>使用者，我是不希望自己去手写创建代码的，控件里的子view都是<code>XTStepper.xib</code>创建的，通过<code>func loadViewFromNib() -&gt; UIView</code>加载。这样做的好处就是所见即所得，而且我们不用写那些繁琐的constraint。<code>XTStepper.xib</code>长这个样子。</p>
<p><img src="http://i1.tietuku.com/f25171f2dc60c6d2.jpg" alt="image3"></p>
<p>打开<code>Main.storyboard</code>文件，却发现一片空白，完全看不到我们设计好的控件的样子。</p>
<p><img src="http://i1.tietuku.com/d8525a8f63acbda0.jpg" alt="image4"></p>
<p>我们所需要做的很简单，只要在我们希望实时渲染的自定义控件前加上<code>@IBDesignable</code>关键字即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import UIKit</span><br><span class="line"></span><br><span class="line">@IBDesignable class XTStepper: UIControl &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在让我们来见证一下它的魔力。</p>
<p><img src="http://i1.tietuku.com/20c34dd45cf6e677.jpg" alt="image5"></p>
<p>虽然只有加一个关键字这么简单，我们仍然要注意，因为从<code>storyboard</code>创建<code>ViewController</code>调用的是这个初始化方法，我们一定要覆写<code>init(coder aDecoder: NSCoder)</code>，做初始化工作。现在控件已经是我们所希望看到的样子了，但这还不够。<code>UIStepper</code>是可以动态调整相关的属性，来控制控件的状态的，我们也想要<code>VisulStepper</code>一样好用。</p>
<p>###@IBInspectable动态更新<br>我们为<code>VisualStepper</code>添加三个类似于<code>TNStepper</code>的属性，当前值<code>value</code>、<code>maxinumValue</code>和<code>minmumValue</code>，当这几个值发生变化的时候，控件的<code>+``-</code>的可用状态会发生变化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func updateApperance()&#123;</span><br><span class="line">    valueLabel.text = String(value)</span><br><span class="line">    minusButton.enabled = value &gt; minmumValue &amp;&amp; value &lt;= maxinumValue</span><br><span class="line">    plusButton.enabled = value &gt;= minmumValue &amp;&amp; value &lt; maxinumValue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们希望可以在<code>InterfaceBuilder</code>里设置这些属性，方法很简单，在属性前加上<code>@IBInspectable</code>。我们可以看到刚才定义的几个属性，在这里我们可以设置他们的值。</p>
<p><img src="http://i1.tietuku.com/50faa7c83be63e73.jpg" alt="image6"></p>
<p>在设置的时候，我们发现控件的状态不会变化，即使<code>value &lt;= minumValue</code>了，<code>-</code>仍然是可以点击的状态，因此我们需要在检测到值变化的时候，去更新我们控件的状态。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@IBInspectable var value:Int = 0 &#123;</span><br><span class="line">    didSet&#123;</span><br><span class="line">        sendActionsForControlEvents(UIControlEvents.ValueChanged)</span><br><span class="line">        self.updateApperance()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@IBInspectable var maxinumValue:Int = 0 &#123;</span><br><span class="line">    didSet&#123;</span><br><span class="line">        self.updateApperance()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@IBInspectable var minmumValue:Int = 0 &#123;</span><br><span class="line">    didSet&#123;</span><br><span class="line">        self.updateApperance()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>至此我们完成了一个更好用的更像<code>UIStepper</code>的自定义<code>Stepper</code>。</p>
<p>###参考文献<br>[1] 王巍：<a href="http://onevcat.com/2014/10/ib-customize-view/" target="_blank" rel="external">WWDC 2014 Session笔记 - 可视化开发，IB 的新时代</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/05/2015-01-05-gong-yu-shan-qi-shi-,bi-xian-li-qi-qi-wo-de-xcodecha-jian/" itemprop="url">
                  工欲善其事，必先利其器-我的XCode插件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-01-05T09:11:18+08:00" content="2015-01-05">
              2015-01-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS开发/" itemprop="url" rel="index">
                    <span itemprop="name">iOS开发</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>XCode为我们提供了一个相对完善的集成开发环境(IDE)，但它仍有诸多不便，在很多地方做的不是那么好，所幸Apple提供了插件编写功能。通过使用多种插件，可以显著提高我们的开发效率。</p>
<p>###<a href="https://github.com/ksuther/KSImageNamed-Xcode" target="_blank" rel="external">KSImageNamed</a><br>你是否曾为<code>[UIImage imageNamed:]</code>无法准确拼出图片名称感到烦恼？是否也曾反复把图片名拷贝到代码里？是否遇到过把图片名大小写搞错而导致真机不能正常显示图片资源？那么这款神器绝对适合你，而且是完全免费的哟。经博主测试，用了<a href="https://github.com/ksuther/KSImageNamed-Xcode" target="_blank" rel="external">KSImageNamed</a>，手不酸了，眼不疼了，一口气写100行。</p>
<p><img src="https://raw.github.com/ksuther/KSImageNamed-Xcode/master/screenshot.gif" alt="Screenshot"></p>
<p>###<a href="https://github.com/onevcat/VVDocumenter-Xcode" target="_blank" rel="external">VVDocumenter</a><br>喵神出品，必属精品。iOS开发大神<a href="http://onevcat.com/" target="_blank" rel="external">onevcat(人称喵神)</a>倾情奉献，分分钟生成API文档，与Apple Documention无缝对接，实乃SDK开发、底层API开发人员居家旅行之利器，你还在等什么！</p>
<p><img src="https://raw.github.com/onevcat/VVDocumenter-Xcode/master/ScreenShot.gif" alt="Screenshot"></p>
<p>###<a href="https://github.com/markohlebar/Peckham" target="_blank" rel="external">Peckham</a><br>拷贝代码忘记import头文件？代码写到上千行引入新类需要导入新类，<code>cmd+shift+f</code>找到这个类，拷贝头文件，然后回到原文件，滚动到顶部再导入。Peckham统统帮你搞定，<code>control+cmd+h</code>一键搞定(靠，明明是三键好不好)，麻麻再也不用担心我导入头文件。</p>
<p><img src="https://raw.githubusercontent.com/markohlebar/Peckham/develop/Misc/Peckham.gif" alt="Peckham.gif"></p>
<p>###<a href="https://github.com/kattrali/cocoapods-xcode-plugin" target="_blank" rel="external">Cocoapods-UI</a><br>不要问我为什么不用酷酷的命令行，因为我懒，Cocoapods的UI工具拿去不谢。</p>
<p><img src="https://github.com/kattrali/cocoadocs-xcode-plugin/raw/master/menu.png" alt="Menu"></p>
<p><strong>以上插件均经博主亲测好用，不满意七天免费退换，邮费自理哈！</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/11/17/2014-11-17-shi-yong-calayerde-maskdong-hua/" itemprop="url">
                  使用CALayer的mask动画
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-11-17T17:13:27+08:00" content="2014-11-17">
              2014-11-17
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS开发/" itemprop="url" rel="index">
                    <span itemprop="name">iOS开发</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Core Animation一直是iOS比较有意思的一个主题，使用Core Animation可以实现非常平滑的炫酷动画。Core animtion的API是较高级的封装，使用便捷，使得我们免于自己使用OpenGL实现动画。本文主要介绍如何使用CALayer的mask实现一个双向注水动画（姑且这么叫吧）。</p>
<p><img src="http://ww3.sinaimg.cn/large/005yyi5Jjw1eme48r7ewwg308c03c0u9.gif" alt="animation gif"></p>
<p>###了解CALayer的mask<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/* A layer whose alpha channel is used as a mask to select between the</span><br><span class="line"> * layer&apos;s background and the result of compositing the layer&apos;s</span><br><span class="line"> * contents with its filtered background. Defaults to nil. When used as</span><br><span class="line"> * a mask the layer&apos;s `compositingFilter&apos; and `backgroundFilters&apos;</span><br><span class="line"> * properties are ignored. When setting the mask to a new layer, the</span><br><span class="line"> * new layer must have a nil superlayer, otherwise the behavior is</span><br><span class="line"> * undefined. Nested masks (mask layers with their own masks) are</span><br><span class="line"> * unsupported. */</span><br><span class="line"></span><br><span class="line">@property(strong) CALayer *mask;</span><br></pre></td></tr></table></figure></p>
<p>以上是<code>CALayer</code>的头文件关于<code>mask</code>的说明，<code>mask</code>实际上<code>layer</code>内容的一个遮罩，如果我们把<code>mask</code>是透明的，实际看到的layer是完全透明的，也就是说只有mask的内容不透明的部分和<code>layer</code>叠加的部分才会显示出来，效果如下：</p>
<p><img src="http://ww2.sinaimg.cn/large/005yyi5Jjw1eme4xwfhzxj30xo0fatdm.jpg" alt="Layer mask"></p>
<p>###实现思路<br>设计的思路参考<a href="http://www.iwangke.me/2014/10/06/how-to-implement-a-core-animation-based-60-fps-ktv-lyrics-view/" target="_blank" rel="external">《基于Core Animation的KTV歌词视图的平滑实现》</a>，<a href="https://github.com/facebook/Shimmer" target="_blank" rel="external">Facebook Shimmer</a>。</p>
<p><img src="http://ww3.sinaimg.cn/large/005yyi5Jjw1eme51fumf8j30w80hk7ag.jpg" alt="flow"><br>在<code>View</code>上重叠放置两个<code>UIImageView</code>: <code>grayHead</code>&amp;<code>greenHead</code>，默认<code>greenHead</code>会遮挡住<code>grayHead</code>。为<code>greenHead</code>设置一个<code>mask</code>，这个mask不是普通的<code>mask</code>，它由两个<code>subLayer</code>:<code>maskLayerUp``maskLayerDown</code>组成。默认情况下，<code>subLayer</code>都显示在<code>mask</code>内容之外，此时<code>mask</code>实际上透明的，由此<code>greenHead</code>也是透明的。现在我们希望<code>greenHead</code>从左上角和右下角慢慢显示内容，那么我们只需要从两个方向为<code>greenHead</code>填充内容就可以了。</p>
<p>###代码片段</p>
<ul>
<li>创建<code>mask</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">- (CALayer *)greenHeadMaskLayer</span><br><span class="line">&#123;</span><br><span class="line">    CALayer *mask = [CALayer layer];</span><br><span class="line">    mask.frame = self.greenHead.bounds;</span><br><span class="line">    </span><br><span class="line">    self.maskLayerUp = [CAShapeLayer layer];</span><br><span class="line">    self.maskLayerUp.bounds = CGRectMake(0, 0, 30.0f, 30.0f);</span><br><span class="line">    self.maskLayerUp.fillColor = [UIColor greenColor].CGColor; // Any color but clear will be OK</span><br><span class="line">    self.maskLayerUp.path = [UIBezierPath bezierPathWithArcCenter:CGPointMake(15.0f, 15.0f)</span><br><span class="line">                                                           radius:15.0f</span><br><span class="line">                                                       startAngle:0</span><br><span class="line">                                                         endAngle:2*M_PI</span><br><span class="line">                                                        clockwise:YES].CGPath;</span><br><span class="line">    self.maskLayerUp.opacity = 0.8f;</span><br><span class="line">    self.maskLayerUp.position = CGPointMake(-5.0f, -5.0f);</span><br><span class="line">    [mask addSublayer:self.maskLayerUp];</span><br><span class="line">    </span><br><span class="line">    self.maskLayerDown = [CAShapeLayer layer];</span><br><span class="line">    self.maskLayerDown.bounds = CGRectMake(0, 0, 30.0f, 30.0f);</span><br><span class="line">    self.maskLayerDown.fillColor = [UIColor greenColor].CGColor; // Any color but clear will be OK</span><br><span class="line">    self.maskLayerDown.path = [UIBezierPath bezierPathWithArcCenter:CGPointMake(15.0f, 15.0f)</span><br><span class="line">                                                             radius:15.0f</span><br><span class="line">                                                         startAngle:0</span><br><span class="line">                                                           endAngle:2*M_PI</span><br><span class="line">                                                          clockwise:YES].CGPath;</span><br><span class="line">    self.maskLayerDown.position = CGPointMake(35.0f, 35.0f);</span><br><span class="line">    [mask addSublayer:self.maskLayerDown];</span><br><span class="line"></span><br><span class="line">    return mask;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>做动画</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (void)startGreenHeadAnimation</span><br><span class="line">&#123;</span><br><span class="line">    CABasicAnimation *downAnimation = [CABasicAnimation animationWithKeyPath:@&quot;position&quot;];</span><br><span class="line">    downAnimation.fromValue = [NSValue valueWithCGPoint:CGPointMake(-5.0f, -5.0f)];</span><br><span class="line">    downAnimation.toValue = [NSValue valueWithCGPoint:CGPointMake(10.0f, 10.0f)];</span><br><span class="line">    downAnimation.duration = duration;</span><br><span class="line">    [self.maskLayerUp addAnimation:downAnimation forKey:@&quot;downAnimation&quot;];</span><br><span class="line">    </span><br><span class="line">    CABasicAnimation *upAnimation = [CABasicAnimation animationWithKeyPath:@&quot;position&quot;];</span><br><span class="line">    upAnimation.fromValue = [NSValue valueWithCGPoint:CGPointMake(35.0f, 35.0f)];</span><br><span class="line">    upAnimation.toValue = [NSValue valueWithCGPoint:CGPointMake(20.0f, 20.0f)];</span><br><span class="line">    upAnimation.duration = duration;</span><br><span class="line">    [self.maskLayerDown addAnimation:upAnimation forKey:@&quot;upAnimation&quot;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong><a href="https://github.com/wuwen1030/CALayerAnimationDemo" target="_blank" rel="external">完整代码</a></strong></p>
<p>###小结<br><code>CALayer</code>提供另外一种操作UI的手段，虽然它提供的API比<code>UIView</code>较底层，但它能提供更加丰富的功能和更高的性能(<code>CALayer</code>的动画是在专门的线程渲染的)。涉及到复杂且性能要求高的UI界面，<code>CALayer</code>的作用就比较明显了，比如<a href="https://github.com/facebook/AsyncDisplayKit" target="_blank" rel="external">AsyncDisplayKit</a>。通过本片文章，我们其实也能看出<code>CALayer</code>的一个用处，通常我们处理圆角时会直接去修改<code>CALayer</code>的<code>cornerRadius</code>，但这种做法性能比较差，尤其是放在列表里的时候，现在我们有了<code>mask</code>，这样我们可以直接改变<code>layer</code>的<code>mask</code>，而不会影响到图形渲染的性能。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/11/12/2014-11-12-yong-octopressxie-bo-ke/" itemprop="url">
                  用Octopress写博客
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2014-11-12T16:14:34+08:00" content="2014-11-12">
              2014-11-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/非技术类/" itemprop="url" rel="index">
                    <span itemprop="name">非技术类</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从昨天晚上折腾到现在终于把Octopress的环境搭好了，网上有很多搭建环境的例子，无奈有些说的不是很明确，东拼西凑了一些教程，这些都非本人原创，把我的经历给大家分享下，让大家少走弯路。</p>
<p>最近产生了写博客的想法，一方面想把自己的开发经历和技术经验分享出来，另一方面也希望在写作的过程中能加深自己的了解。个人比较喜欢<a href="http://onevcat.com/" target="_blank" rel="external">喵神</a>和<a href="http://blog.devtang.com/" target="_blank" rel="external">唐巧</a>的技术博客的风格，喵神的Blog模板没有尝试，主要参考唐巧的<a href="http://blog.devtang.com/blog/2012/02/10/setup-blog-based-on-github/" target="_blank" rel="external">文章</a>，完成了本文的写作环境的搭建。</p>
<p>###搭建<br>搭建环境主要参考这里<a href="http://blog.devtang.com/blog/2012/02/10/setup-blog-based-on-github/" target="_blank" rel="external">http://blog.devtang.com/blog/2012/02/10/setup-blog-based-on-github/</a>，大家直接跳过去看就好了。主要说说我的经验，ruby的环境不需要1.9.3的，Yosemite默认的2.0是Ok的，所以没必要纠结地去装gcc 4.2，直接装Octopress就行。<code>gem install bundler</code>相当地慢，曾经就因为这个放弃了一次，这个没被墙，就是慢，耐心等一下。</p>
<p>文章里漏掉的一点就是设置octopress与github-pages的连接，第一次发布，在执行<code>rake deploy</code>之前，要先执行<code>rake setup_github_pages</code>，在输入提示中输入你的github-pages地址，比如我的<code>git@github.com:wuwen1030/wuwen1030.github.io.git</code>。大家在配置好，最好就不要手动去改github-pages的内容啦，这可能会导致发布失败噢，原因就是octopress的发布内容和github服务端的内容不一致造成的，deploy 时明明看到 git pull… 了，没搞懂，大家如果知道请指教一下。</p>
<p>deploy之后，发现和大神的Blog还是很不一样嘛，不知道从哪儿窜出来的各种英文，现在需要配置一下，定制自己的模板啦。</p>
<p>###配置<br>唐巧的文章配置这块写的不是太细，谷歌，DuckDuckGo被各种屏蔽，只好求助度娘，配置主要是参考<a href="http://www.cnblogs.com/oec2003/archive/2013/05/31/3109577.html" target="_blank" rel="external">http://www.cnblogs.com/oec2003/archive/2013/05/31/3109577.html</a>。大家自行阅读吧，写的很细了。配置这块还有很多可研究的，待以后深入研究再补充上来。</p>
<p>至此，你已经得到了一个看起来很酷的blog模板了，可以拿出来装一装了（Octopress号称就是给Hacker用的么），唯一的问题就是访问速度很慢，不过没关系，已经有解决方案了，拿来主义的博主再次发出链接大招<a href="http://blog.devtang.com/blog/2014/06/02/use-gitcafe-to-host-blog/" target="_blank" rel="external">http://blog.devtang.com/blog/2014/06/02/use-gitcafe-to-host-blog/</a>，一步步按照文章里的来，像我这样的小白也能搞好。感谢方校长的GFW成功阻击境外反动势力对我国的渗透，即使切到GitCafe你的Blog访问速度依然很慢，查看你主页的源码，你会看到这个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;link href=&quot;//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</span><br><span class="line">&lt;link href=&quot;//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>问题就在这里，替换掉Google的jquery和font链接，打开/source/index.html，做如下替换：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 替换jquery ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js--&gt;</span><br><span class="line">&lt;script src=&quot;http://ajax.useso.com/ajax/libs/jquery/1.9.1/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>打开 source/_includes/custom/head.html，替换成如下代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--Fonts from Google&quot;s Web font directory at http://google.com/webfonts --&gt;</span><br><span class="line">&lt;link href=&quot;http://fonts.useso.com/css?family=PT+Serif:regular,italic,bold,bolditalic&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</span><br><span class="line">&lt;link href=&quot;http://fonts.useso.com/css?family=PT+Sans:regular,italic,bold,bolditalic&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>###后话<br>完成这些之后，你就可以像博主一样使用优雅的<strong>Markdown</strong>在这写作，推荐一个不错的Mac开源<a href="http://macdown.uranusjr.com/" target="_blank" rel="external">Markdown编辑工具</a>。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="BenXia" />
          <p class="site-author-name" itemprop="name">BenXia</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">4</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">BenXia</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=0.5.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  
  

  


</body>
</html>
